---
title: "熵"
categories: ["热力学", "工程热力学"]
---

本章中我们将主要介绍热力学系统中熵的概念。

## 熵的基本属性

### 熵的定义

在研究热力学第二定律的过程中，克劳修斯给出了著名的克劳修斯不等式：

任何工作在循环上的热机满足：
$$\oint \frac{\delta Q}{T} \le 0$$
{: .theorem}

这是热力学第二定律最知名的数学表述之一。

考虑连接至恒温热源$T\_R$，工作在循环上的一个可逆的热机，外界对该热机做功为$\delta W\_\text{可逆}$，输出的热量连接至某一温度为$T$的系统，外界对该系统做的功为$\delta W\_\text{系统}$，对整体应用热力学第一定律，有：
$$
\def\d{\mathrm{d}}
\delta W_\text{可逆} + \delta W_\text{系统} + \delta Q_R = \delta W + \delta Q_R = \d E
$$
其中$Q\_R$表示从热库吸收的热量。
考虑到该热机是可逆的，则运用上一章的结论，可得：
$$\frac{\delta Q_R}{\delta Q} = \frac{T_R}{T} \iff \frac{\delta Q_R}{T_R} = \frac{\delta Q}{T}$$
其中$\delta Q$表示从热机向系统转移的热量。
代入上式，可得：
$$\delta W + T_R \frac{\delta Q}{T} = \d E_C$$
对一个循环，由于系统的能量是状态量，其保持不变，因此：
$$W + T_R \oint \frac{\delta Q}{T} = \oint \d E_C = 0$$
根据热力学第二定律，循环的系统不可能从单一热源吸收热量并做功，因此：
$$W \ge 0 \implies \oint \frac{\delta Q}{T} \le 0$$
特别地，如果整个系统都是内可逆的，则考虑该过程的逆过程。
根据相同的推理，不难发现$W \le 0$，从而等号成立：
$$W=0 \implies \oint \frac{\delta Q}{T} = 0$$
{: .proof}

对内可逆的过程，物理量$\oint \frac{\delta Q}{T}$为零，这意味着$\frac{\delta Q}{T}$是一个状态量。
我们据此定义一个新的物理量：

熵是一个热力学系统的广延性质，其变化量定义为：
$$\Delta S = \int_1^2 \left( \frac{\delta Q}{T} \right)_\text{内可逆}$$
微分形式为
$$\d S = \left( \frac{\delta Q}{T} \right)_\text{内可逆}$$
其零点由热力学第三定律确定。
{: .definition}

注意到熵的定义中要求一个过程为内部可逆的，而显然并非所有过程都满足该要求。
幸而，根据定义，熵是一个状态量，与过程无关，因此我们可以通过构造两个状态之间的任意一个内部可逆过程（或者全可逆过程）来求解熵变。

对于内部可逆的等温过程，该定义简化为：
$$\Delta S_\text{等温} = \frac{1}{T} \int_1^2 \delta Q = \frac{Q}{T}$$

#### 确定纯净物的熵

由于熵是广延性质，液-汽相变中的物质单位质量的熵可由某一项的分数确定：
$$s = s_f + x s_\mathit{fg}$$
其中下标$f$表示饱和液体的熵，$\mathit{fg}$表示相变熵，均可通过查表确定。

当液体处于压缩状态时，其熵可由饱和液体的熵近似。

### 熵增原理

封闭的热力学系统满足：
$$\d S \ge \frac{\delta Q}{T}$$
而孤立（或绝热）的热力学系统满足：
$$\d S \ge 0$$
即，孤立的热力学系统的熵不能减小，这一命题称为孤立系统的熵增原理。
{: .proposition}

先证明孤立系统的命题，然后取$\delta Q = 0$即可。
考虑两个过程，第一个从状态1变为状态2，是可逆或不可逆的，第二个从状态2回到状态1，是可逆的，根据克劳修斯不等式：
$$\oint \frac{\delta Q}{T} = \int_1^2 \frac{\delta Q}{T} + \int_2^1 \frac{\delta Q}{T} \le 0$$
而第二个过程是可逆的，从而根据定义其积分就是熵变化量：
$$\int_1^2 \frac{\delta Q}{T} + (S_1 - S_2) \le 0 \iff \int_1^2 \frac{\delta Q}{T} \le S_2 - S_1 = \Delta S$$
取微分即可。
{: .proof}

对于任何一个非孤立的系统，我们总是可以将其环境看成另一个系统，然后将两个系统组合起来，得到一个孤立的系统。
对该孤立系统应用熵增原理，可得
$$\Delta S_\text{总} = \Delta S_\text{系统} + \Delta S_\text{环境} \ge 0$$
在某个过程中，系统和环境总的增加的熵即是该过程生成的熵。

从而，熵增原理说明，任何过程总不能使得熵的总量减小，或者任何过程总是会产生非负的熵。
这一命题并不表示系统中一个过程的熵变不能为负，而是表示系统和环境总的熵变不能为负，系统的熵可以转移到环境里，从而使得系统内的熵减小。

### 等熵过程

封闭系统熵的变化只能由不可逆性和热量交换产生，因此绝热且内部可逆的过程一定是等熵的：
$$\Delta s = s_2 - s_1 = 0$$

工程上可见的绝热热力学过程，如泵、涡轮和喷嘴中发生的热力学过程，其中的不可逆性（如摩擦等）往往可以忽略，因此可以由等熵过程进行建模。

值得注意的是，等熵过程并不一定需要是绝热且可逆的。
如果一个系统的不可逆性导致的熵增和热量交换导致的熵减抵消，过程也可能是等熵的。

工程上的等熵过程通常就专指绝热可逆过程。

## 熵的计算

### 热力学基本关系

对内部可逆的静止简单可压缩系统，有
$$T \d S = \d U + P \d V = \d H - V \d P$$
其单位质量形式为：
$$T \d s = \d u + P \d v = \d h - v \d P$$
这一命题称为热力学基本关系（Fundamental thermodynamic relation）。
{: .proposition}

根据热力学第一定律，有：
$$\d E = \d U = \delta Q + \delta W$$
对内部可逆的系统，我们知道
$$\delta Q = T \delta S$$
此外其功只有体积功，从而
$$\delta W = - P \d V$$
代入即可得：
$$\d U = T \d S - P \d V$$
移项即可。
然后代入焓的定义
$$H = U + PV \implies \d H = \d U + P \d V + V \d P$$
即可。
{: .proof}

热力学基本定理将熵和几个已知的状态参数联系了起来，从而方便我们对其进行求解。

值得注意的是，尽管热力学基本关系在定义的时候说明必须使用在内部可逆的静止简单可压缩系统中，但是由于熵是状态量，因此该关系求出的熵变可应用在任何系统中的任何系统上。
因为我们总是可以在两个状态之间构造可逆的过程，然后利用该过程求出熵变。

### 固体和液体的熵

固体和液体可近似认为不可压缩，从而热力学基本关系可写为：
$$\d s = \frac{\d u}{T} = \frac{c \d T}{T}$$
对其积分，然后用平均比热替代根据温度变化的比热，可得：
$$\Delta s = \int_1^2 c(T) \frac{\d T}{T} = c_\text{平均} \ln \frac{T_2}{T_1}$$

由该结果马上可以得到以下推论：
固体和液体的等熵变化总是等温的。

### 理想气体的熵

对理想气体，代入$\d u = c\_v \d T$和$Pv = R\_\text{spec} T$，可得：
$$\d s = c_v \frac{\d T}{T} + R_\text{spec} \frac{\d v}{v}$$
然后积分，即可得
$$\Delta s = \int_1^2 c_v (T) \frac{\d T}{T} + R_\text{spec} \ln \frac{v_2}{v_1}$$

此外，代入$\d h = c\_p \d T$并积分，可得：
$$\Delta s = \int_1^2 c_p (T) \frac{\d T}{T} - R_\text{spec} \ln \frac{P_2}{P_1}$$

除了比热是常数的单原子气体外，理想气体的比热通常是温度的非线性函数。
因此，直接进行积分可能比较困难，我们可以使用常数替代比热进行估计，或者通过查表得到精确的值。

#### 近似估计

如果使用常数对理想气体的比热进行估计，则上面的式子可以化为以下形式：
$$\Delta s = c_v \ln \frac{T_2}{T_1} + R \ln \frac{v_2}{v_1} = c_p \ln \frac{T_2}{T_1} - R \ln \frac{P_2}{P_1}$$

#### 精确计算

理想气体的熵不仅取决于温度，还取决于压力（或密度），因此不可能通过查表的方式来进行求解。
相对地，我们注意到其熵是一个只取决于温度的函数和另一个简单的函数的线性组合，因此我们可以对其中一个进行查表。

定义
$$s^\circ = \int_0^T c_p(T) \frac{\d T}{T}$$
我们可以通过对$s^\circ$查表来得出熵变：
$$\Delta s = s^\circ_2 - s^\circ_1 - R \ln \frac{P_2}{P_1}$$

#### 等熵过程

如果继续使用常数近似理想气体的比热，则在等熵变化中，有
$$\Delta s = 0 \iff \ln \frac{T_2}{T_1} = - \frac{R_\text{spec}}{c_v} \ln \frac{v_2}{v_1}$$
注意到
$$R_\text{spec} = c_p - c_v, \ k = \frac{c_p}{c_v} \implies \frac{R_\text{spec}}{c_v} = k-1$$
从而
$$\frac{T_2}{T_1} = \left( \frac{v_2}{v_1} \right)^{-(k-1)} = \left( \frac{v_1}{v_2} \right)^{k-1}$$

同理，对含有焓的式子也可得到：
$$\frac{T_2}{T_1} = \left( \frac{P_2}{P_1} \right)^{\frac{(k-1)}{k}}$$

因此有
$$\left( \frac{P_2}{P_1} \right) = \left( \frac{v_1}{v_2} \right)^k$$

#### 相对压力

如果不使用常数近似，则可得到
$$0 = s^\circ_2 - s^\circ_1 - R \ln \frac{P_2}{P_1} \implies s^\circ_2 = s^\circ_1 + R_\text{spec} \ln \frac{P_2}{P_1}$$

进一步变化，可得：
$$\frac{P_2}{P_1} = \exp \frac{s^\circ_2 - s^\circ_1}{R_\text{spec}} \implies \frac{P_2}{P_1} = \frac{\exp \frac{s_2^\circ}{R_\text{spec}}}{\exp \frac{s_1^\circ}{R_\text{spec}}}$$

因此，我们可定义理想气体的相对压力。

理想气体的*相对压力*（Relative pressure）定义为：
$$P_r \propto \exp \frac{s^\circ}{R_\text{spec}} \iff P_r = C \exp \frac{s^\circ}{R_\text{spec}}$$
其中$C$为一常数。
{: .definition}

相对压力是一个无量纲量，可以制表并通过表格查出。
利用相对压力，可以非常方便地求解等熵过程压力的变化：
$$\frac{P_2}{P_1} = \frac{P_{r,2}}{P_{r,1}}$$

同理，我们也能定义相对比体积并查表得出等熵过程比体积（或密度）的变化。

## 定常流动的熵

### 可逆定常流动的功

对*可逆*的过程，根据熵的定义和热力学基本关系，可得：
$$\delta q = \d h - v \d P$$
代入热力学第一定律中
$$\delta q + \delta w = \d h + \d e_k + \d e_p \implies \delta w - v \d P = \d e_k + \d e_p$$
进行积分，可得
$$w = \int_1^2 v \d P + \Delta e_k + \Delta e_p$$

若动能和势能变化可忽略，则可得：
$$w = \int_1^2 v \d P$$
根据该等式，可逆过程的功与工质的密度具有很大的关系。
若工质的密度大，则功的交换更多，因此在压缩机之类的设备中，我们希望提高工质的密度，降低工质的比容，从而降低功的消耗；相对地，在需要做功时，则希望尽量降低工质的密度，而提高功的输出。

和工作在循环中的热机一样，定常流动在可逆时输出功最大而消耗功最小。

若系统不做功，只考虑重力势能，且工质不可压缩，则有
$$v(P_2 - P_1) + \frac{V_2^2 - V_1^2}{2} + g(z_2 - z_1) = 0$$
这一方程称为伯努利定律。

### 降低压缩机的功消耗

我们知道气体的比容通常随温度的下降而下降，因此在进入压缩机前对工质进行冷却可以降低其功消耗。

假设初状态相同而输出压力相同，考虑三个过程：没有冷却的等熵过程、部分冷却的多方过程和完全冷却的等温过程。

对等熵过程，注意到$Pv^k = C$，进行积分，可得：
$$w = \frac{kR_s(T_2 - T_1)}{k-1} = \frac{kR_sT_1}{k-1} \left[ \left(\frac{P_2}{P_1}\right)^{\frac{k-1}{k}} - 1\right]$$
对多方过程，注意到$Pv^n = C$，进行积分，可得：
$$w = \frac{nR_s(T_2 - T_1)}{n-1} = \frac{nR_sT_1}{n-1} \left[ \left(\frac{P_2}{P_1}\right)^{\frac{n-1}{n}} - 1\right]$$
对等温过程，注意到$Pv = R_s T$，进行积分，可得：
$$w = R_s T \ln \frac{P_2}{P_1}$$

通过画图等方式不难注意到等温过程需要的功最少，多方过程次之，等熵过程的最大。

为了进行有效的冷却，通常使用多级冷却的方式进行降温。
此时，压缩过程被分为多个代表不完全冷却压缩的多方过程和之间的冷却环节。

考虑两个多方过程，其中由一个压力为$P\_x$的冷却环节隔开，则需要的功变为：
$$w = \frac{nR_sT_1}{n-1} \left[ \left(\frac{P_x}{P_1}\right)^{\frac{n-1}{n}} - 1\right] + \frac{nR_sT_1}{n-1} \left[ \left(\frac{P_2}{P_x}\right)^{\frac{n-1}{n}} - 1\right]$$
该等式只有一个变量$P\_x$，通过求导，可发现其在
$$P_x = \sqrt{P_1 P_2}$$
处取最小值。

### 定常流动设备的等熵效率

对热机，我们使用可逆循环的输出与实际输出之比来确定其效率；
对于定常流动的设备，我们也可以使用等熵或绝热的输出来定义其效率。

我们主要考虑涡轮和压缩机一类的设备，根据之前的研究，有
$$q + w = \Delta h + \Delta e_k + \Delta e_p$$
这一类设备的变化通常可视为绝热的，因此$q = 0$。

涡轮的等熵效率定义为：
$$\eta_T = \frac{w_\text{实际}}{w_\text{等熵}}$$
若忽略工质的动能和势能的变化，其等熵效率可写为：
$$\eta_T \approx \frac{h_1 - h_{2,\text{实际}}}{h_1 - h_{2,\text{等熵}}}$$
{: .definition}

压缩机的等熵效率定义为
$$\eta_C = \frac{w_\text{等熵}}{w_\text{实际}}$$
若忽略工质的动能和势能的变化，其等熵效率可写为：
$$\eta_C \approx \frac{h_{2,\text{等熵}} - h_1}{h_{2,\text{实际}} - h_1}$$
{: .definition}

同理，若忽略工质的动能和势能的变化且将工质视为不可压缩，泵的等熵效率可写为：
$$\eta_P = \frac{w_\text{等熵}}{w_\text{实际}} = \frac{v (P_2 - P_1)}{h_{2,\text{实际}} - h_1}$$

如果考虑的是进行了冷却的压缩机，那么使用等温效率比等熵效率能更好地表示最小消耗功。
等温效率定义为：
$$\eta_C' = \frac{w_\text{等温}}{w_\text{实际}}$$

---

接下来考虑喷嘴的等熵效率。
与涡轮等不同，我们不能忽略喷嘴的动能变化。
实际上正好相反，我们需要利用动能来定义喷嘴的效率。

喷嘴的等熵效率定义为：
$$\eta_N = \frac{e_{k, \text{出口}, \text{实际}}}{e_{k, \text{出口}, \text{等熵}}} = \frac{V^2_{2, \text{实际}}}{V^2_{2, \text{等熵}}}$$
{: .definition}

如果忽略喷嘴的做功和势能变化，并认为输入端的动能远小于输出端的，则有：
$$h_\text{输入} = h_\text{输出} + \frac{V_{2}^2}{2}$$
因此其等熵效率可有焓变表示：
$$\eta_N = \frac{h_1 - h_{2,\text{实际}}}{h_1 - h_{2,\text{等熵}}}$$

## 熵平衡

熵增原理说明任何一个不可逆的过程都会产生熵，因此系统的总熵变可表示为随热量交换而进入或离开系统导致的熵变和过程产生的熵之和。
我们可以分别研究这几项。

### 熵变关系

#### 系统的熵变

系统的熵变即终态与初态之间系统总熵的差。
$$\Delta S_\text{系统} = S_2 - S_1$$

若熵的分布不是均匀的，则可通过积分的方式求解：
$$S_\text{系统} = \int s \delta m = \int_V s \rho \delta \tau$$

#### 熵的传递

系统和外界的交换有三种形式：热量、功和质量。
其中，热量和质量交换会产生熵，而功不会。

热量产生的熵变表示为：
$$S_\text{热量} = \int_1^2 \frac{\delta Q}{T}$$
若发生热量交换的位置的温度保持不变，则有：
$$S_\text{热量} = \frac{Q}{T}$$

通过质量交换得到的熵变可写为
$$S_\text{质量} = m s$$
从而其对时间的微分可以写成：
$$\dot S_\text{质量} = \int_S s \rho \vec V \cdot \d \vec S$$

#### 生成的熵

在系统内部，任何过程生成的熵可由熵平衡公式计算得到：
$$S_\text{生成} = \Delta S_\text{系统} - \Delta S_\text{传递}$$

而当我们需要求出整个过程生成的熵时，还需要考虑该过程导致的环境的熵变。
我们可以将系统周围紧邻的一部分环境纳入考虑范围，并研究系统与环境发生的热量和质量传递导致的环境熵增加量。
此时，我们常常将环境温度视为常数，因此，在只发生热量交换的情况下，环境的熵变可写为：
$$\Delta S_\text{环境} = \frac{Q}{T_\text{环境}}$$

### 计算生成的熵

#### 封闭系统

对封闭系统，熵平衡的最一般形式为：
$$\Delta S_\text{交换} + S_\text{生成} = \Delta S_\text{系统}\implies \int \frac{\delta Q}{T} + S_\text{生成} = S_2 - S_1$$

如果系统是绝热的，那么交换产生的熵变为零，而系统的熵变都是生成的。

我们可以把系统和其周围足够大的环境一并纳入考虑，此时可将新的系统视为隔热的：
$$S_\text{生成} = \Delta S_\text{系统} + \Delta S_\text{环境} = \Delta S_\text{系统} + \int \frac{\delta Q_\text{环境}}{T_\text{环境}} = \Delta S_\text{系统} - \int \frac{\delta Q}{T_\text{环境}}$$

更进一步地，若环境温度不变，则：
$$S_\text{生成} =  \Delta S_\text{系统} - \frac{Q}{T_\text{环境}}$$

#### 开放系统

对控制体积，即开放系统，我们还需要考虑质量交换导致的熵变，此时有：
$$
\begin{multline}
\Delta S_\text{交换} + S_\text{生成} = \Delta S_\text{系统}\\ \implies \int \frac{\delta Q}{T} + \sum m_\text{入} s_\text{入} - \sum m_\text{出} s_\text{出} + S_\text{生成} = S_2 - S_1
\end{multline}
$$
或者可以表示成速率的形式：
$$
\int \frac{\delta \dot Q}{T} + \sum \dot m_\text{入} s_\text{入} - \sum \dot m_\text{出} s_\text{出} + \dot S_\text{生成} = \frac{\d S}{\d t}
$$

对定常流动，可得：
$$
\dot S_\text{生成} = \sum \dot m_\text{出} s_\text{出} - \sum \dot m_\text{入} s_\text{入} - \int \frac{\delta \dot Q}{T}
$$

如果只有一个入口与出口，则还能进一步简化：
$$\dot S_\text{生成} = \dot m (s_\text{出} - s_\text{入}) - \int \frac{\delta \dot Q}{T}$$

如果还是绝热的，则：
$$\dot S_\text{生成} = \dot m (s_\text{出} - s_\text{入})$$
