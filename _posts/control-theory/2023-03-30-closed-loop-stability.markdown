---
title: "闭环系统的稳定性"
categories: "控制理论"
---

本文中我们研究使用奈奎斯特判据来判定闭环系统的稳定性。

## 柯西辐角原理

我们首先介绍一个关键的定理，这个原理可以将零点和极点转化为辅角的计数。

设$H(p)$为一线性传递函数，其零点记为$z\_i$，极点记为$p\_j$，$C$为复平面上不通过其零点和极点的闭合曲线（或称“围道”）。
我们记$Z\_C [H(p)]$为曲线包围的零点个数，$P\_C [H(p)]$为曲线包围的极点个数。
{: .definition}

若$(C)$为一不通过传递函数零点和极点的闭合曲线，那么我们（不加证明地）说$H(C)$是一个不通过*零点*的闭合曲线。
{: .proposition}

设$H(p) = \frac{K \sum (p - z\_i)}{\sum (p - p\_i)}$。
我们有：
$$
\begin{aligned}
    \arg [H(p)] &= \arg \left[ \frac{K \sum (p - z_i)}{\sum (p - p_i)} \right] \\
    &= \arg [K] + \arg \sum (p - z_i) - \arg \sum (p - p_i) \\
    &= \sum \arg (p - z_i) - \sum \arg (p - p_i)
\end{aligned}
$$
接下来，我们进行积分以求出整个闭合曲线$(C)$绕过零点的圈数：
$$
\begin{aligned}
    \oint_C \arg [H(p)] \mathrm d p &= \oint_C \sum \arg (p - z_i) - \sum \arg (p - p_i) \mathrm d p \\
    &= \oint_C \sum_{\text{内部}} \arg (p - z_i) - \sum_{\text{内部}} \arg (p - p_i) \mathrm d p \\
    &+ \oint_C \sum_{\text{外部}} \arg (p - z_i) - \sum_{\text{外部}} \arg (p - p_i) \mathrm d p \\
\end{aligned}
$$
不难注意到，外部的零点和极点对闭合曲线的点的辅角的积分为零（可画图验证），因此实际上仅有内部的零点和极点对辅角的积分有贡献。
这说明闭合曲线$H(C)$顺时针绕过零点的圈数等于顺时针绕过*内部零点*的圈数减去顺时针绕过*内部极点*的圈数，这就是柯西辐角原理。

（辐角原理）对任何不通过传递函数零点和极点的闭合曲线$C$，有：
$$
N_O^{\text{顺}} [H(C)] = Z_C [H(p)] - P_C [H(p)]
$$
其中$N\_O^{\text{顺}} [H(C)]$是闭合曲线$H(C)$顺时针绕过原点的圈数。
{: .theorem}

## 选择传递函数和曲线

现在，我们需要选择正确的传递函数和曲线以利用柯西辐角原理。
为了正确使用这个原理，我们选择传递函数以容易地为辐角原理中的零点个数、极点个数赋予物理意义，同时选择正确的曲线以便进行计数。

### 决定传递函数

首先我们想到的自然是系统本身的传递函数，这个函数的极点当然具有非常显然的物理意义，因为它和稳定性密切相关。
但是，这个函数的零点没有物理意义，因此我们不选择这个函数。

我们使用$H(p) = 1 + H\_{BO}(p)$作为这个传递函数，其中$H\_{BO}$为开环传递函数，这个函数具有几个优点：
1. 这个传递函数是*闭环传递函数*（即输出对输入和扰动的传递函数）的分母，因此其**零点***决定了闭环传递函数的稳定性*，从而决定了原传递函数的稳定性；
2. 这个传递函数的**极点**和$H\_{BO}$相同，从而和开环传递函数的稳定性密切相关。

我们称这个函数为辅助函数，将这个函数代入柯西辅角原理的公式，可得：
$$
\begin{aligned}
    N_O^{\text{顺}} [1+H_{BO}(C)] &= Z_C [1+H_{BO}(p)] - P_C [1+H_{BO}(p)] \\
    &= Z_C [1+H_{BO}(p)] - P_C [H_{BO}(p)]
\end{aligned}
$$

### 决定围道

接下来我们决定围道，即辐角原理中使用的闭合曲线。
我们希望使用这个公式来判定系统的稳定性，而系统的稳定性是由实部非负的极点存在性决定的，因此我们希望选择可以包含所有非负部分。
为此，我们选择**布朗维奇围道**（Bromwich contour），这个围道的基础部分由三个部分组成：
$$
\begin{aligned}
    \gamma &= \{ p = j \omega \; | \; \omega \in (0, +\infty) \} \\
    &\cup \{ p = r_e e^{j\theta} \; | \; \theta \in [-\frac{\pi}{2}, \frac{\pi}{2}], \; r_e \to \infty \} \\
    &\cup \{ p = -j \omega \; | \; \omega \in (0, +\infty) \}
\end{aligned}
$$

之所以说这是基础部分，是因为如果存在虚轴上的零点或极点，则需要稍微修改一下围道以绕过它们，因为柯西辅角原理的前提条件是围道不能通过零点或极点。

我们马上就会看到，这个围道经过辅助函数变换之后，就会和奈奎斯特图有非常紧密的联系。

我们记$\Gamma = 1 + H\_{BO}(\gamma)$，$\Gamma\_0 = H\_{BO}(\gamma)$。
$\Gamma$就是柯西辅角原理中的那个曲线，而这个曲线相当于把$\Gamma\_0$右移一个单位。

接下来我们研究$\Gamma\_0$。
我们将围道的三个部分依次进行变换，对第一个部分，我们有：
$$
H_{BO}(p) = H_{BO}(j \omega), \; \omega \in (0, +\infty)
$$
不难发现这个部分变换后恰好就是开环传递函数的奈奎斯特图。
接着考虑第三个部分：
$$
H_{BO}(p) = H_{BO}(- j \omega) = H_{BO}(\overline{j\omega}) = \overline{H_{BO}(j \omega)}
$$
这个围道部分变换后恰好就是奈奎斯特图沿实轴对称后的图像。
我们暂时忽略第二个部分，不严格地说，对因果系统，分母的次数总是高于分子的，因此在取无穷大时传递函数总是趋于零。

我们注意到，要得到柯西辅角原理中的曲线$\Gamma$，需要将这个曲线$\Gamma\_0$右移一个单位，因此为了求出$\Gamma$绕原点的圈数，我们需要求出$\Gamma\_0$绕$(-1,0)$的圈数。
我们称这个点$(-1,0)$为**临界点**，这个是奈奎斯特图中的一个重要的点。

此外，我们要求$\Gamma$不通过原点，因此$\Gamma_0$不通过临界点。

## 奈氏稳定性判据

我们回到柯西辅角原理，得出最后的结论。

如果一个闭环系统是稳定的，那么其两个闭环传递函数必须都是稳定的，因此包围整个实轴正半轴的布朗维奇围道包围的辅助函数零点必须为零个。
因此有：
$$
\begin{aligned}
    & \text{闭环系统稳定} \\
    & \iff Z_\gamma [1 + H_{BO}(p)] = 0 \\
    & \iff - P_\gamma [H_{BO}(p)] = N_O^\text{顺} [1 + H_{BO}(\gamma)] \\
    & \iff P_\gamma[H_{BO}(p)] = N_{(-1,0)}^\text{逆}[H_{BO}(\gamma)]
\end{aligned}
$$

从而我们得到了奈奎斯特判据：

（奈氏稳定性判据）一个闭环系统是稳定的，当且仅当其奈奎斯特图以及其共轭部分不通过临界点$(-1,0)$，且沿$\omega$增加方向*逆时针*绕过临界点的圈数等于开环传递函数的正实部极点数。
{: .theorem}

### 例子

#### 二阶系统

我们先考虑一个最简单的例子，其*开环*传递函数就是一个二阶系统：
$$
H_{BO} = \frac{K}{(1+\tau_1 p)(1+\tau_2 p)}
$$
考虑到反馈环，其总的传递函数为：
$$
H = \frac{H_{BO}}{1 + H_{BO}}
$$
这是一个比较复杂的函数，但并非完全不能用系数法解决，实际上不难看出只要$k > 0, \tau\_i > 0$，那么系统就是稳定的。
我们用奈奎斯特判据来验证这个结论。

首先我们注意到在所有零点和极点的实部不等于零，因此之前提到的布朗维奇围道不通过任何极点或零点，因此是有效的围道。
然后注意到所有极点的实部小于零，因此围道不包括任何一个极点，从而$P\_\gamma[H\_{BO}(p)] = 0$。

然后我们观察围道被传递函数变换之后的结果，由于这个围道没有被修改过，所以我们直接使用上文中的结论，直接观察其奈奎斯特图。
回忆一下二阶系统的奈奎斯特图如下所示：

![](/assets/system/2-order-0.5-nyquist.png)
{: .align-center}

不难观察到$N\_{(-1,0)}^\text{逆}[H\_{BO}(\gamma)] = 0$。
因此这个系统一定是稳定的。

#### 含有零极点的系统

然后我们来观察一个含有零极点的系统，其开环传递函数为：
$$
H_{BO} = \frac{K}{p(1+\tau p)}
$$

注意到在柯西辐角原理中，我们要求选择的围道不能通过任何一个原点或极点，因此我们不再能使用之前的围道。
实际上，对这个围道稍加修改即可得到一个新的可用的围道：

![](/assets/system/bromwich-contour.svg)
{: .align-center}

我们让这个围道以非常微小的半径$r\_i$逆时针绕过所有实部为零的根，从而规避围道通过零点和极点这个问题。
但是这一截新引入的围道会导致围道被传递函数变换之后的曲线出现变换，因此我们必须重新研究$H(\gamma)$。
我们把新加入的这一段围道称为第四部分，然后研究这个围道。

首先，不难发现任何极点和零点都被该围道包围，因此$P\_\gamma[H\_{BO}(p)] = 0$。

首先，Y轴上的两段围道并未发生任何变化，因此这个围道依然包含奈奎斯特图和其共轭部分。
然后，不难发现这个传递函数的分母次数大于分子次数，因此在无穷远处的围道依然在原点，现在我们来研究这个无穷小的围道。

注意到这个围道可以表示成$r\_i e^{i \theta}$，其中$\theta \in [-\frac{\pi}{2}, \frac{\pi}{2}]$。
$$
\begin{aligned}
    H_{BO}(r_i e^{i \theta}) &= \frac{K}{r_i e^{i\theta} (1 + \tau r_i e^{i\theta})} \\
    &\sim \frac{K}{r_i} e^{-i\theta} \to + \infty
\end{aligned}
$$
从上面的计算中，可以看出，这个围道被变换之后会变为无穷大。
不难验证，当$\theta = -\frac{\pi}{2}$时，这个点在$(0, +\infty)$，而当$\theta = \frac{\pi}{2}$时，这个点在$(0, -
\infty)$。
不难验证 这些点在未被变换之前在围道上相邻的点，在被变换后依然是相邻的。

现在，问题在于，这个围道是顺时针还是逆时针旋转的呢？
显然，当$\theta$从$-\frac{\pi}{2}$上升到$\frac{\pi}{2}$时，辐角$\arg e^{-i\theta}=-\theta$从$\frac{\pi}{2}$下降到$-\frac{\pi}{2}$，因此是顺时针旋转的。

画出奈奎斯特图，并确定整个围道的曲线后，不难发现整个围道不包括临界点，因此$N\_{(-1,0)}^\text{逆}[H\_{BO}(\gamma)] = 0$。
所以这个系统是稳定的。

#### 含有不稳定极点的系统

接下来我们继续研究特殊的系统，比如含有不稳定极点的开环传递函数的系统：
$$
H_{BO}(p) = \frac{K_1 (1+K_2 p)}{p(p-1)}
$$
这个系统含有两个极点，一个是原点，一个在实轴上。

我们继续使用上文中修改的围道，注意此时$P\_\gamma[H\_{BO}(p)] = 1$。

同理，我们也只计算围道的第四个部分的变换：
$$
H_{BO}(r_i e^{i \theta}) \sim - \frac{K_1}{r_i e^{i \theta}} = - \frac{K_1}{r_1} e^{i -\theta}
$$
这个部分依然位于无穷远。
当$\theta$从$-\frac{\pi}{2}$上升到$\frac{\pi}{2}$时，辐角$\arg -\frac{K_1}{r_1} e^{-i\theta}=- \theta - \pi$从$-\frac{\pi}{2}$下降到$-\frac{3\pi}{2}$，所以仍然是顺时针旋转。

为了简捷地判定半圆的旋转方向是顺时针还是逆时针，可以在积分围道上选择几个点（如$\theta = -\frac{\pi}{2}, 0, \frac{\pi}{2}$三个点），计算它们的变换，然后依次连接起来。

观察奈奎斯特图，立即可以发现临界点被曲线环绕几次，取决于奈奎斯特图与实轴的交点在临界点的左侧还是右侧：

![](/assets/system/nyquist-instable.svg)
{: .align-center}

![](/assets/system/nyquist-stable.svg)
{: .align-center}

这两种情况对应的系统稳定性并不相同。
对于前者，临界点被顺时针环绕一次，因此是不稳定的；
对于后者，临界点被逆时针环绕一次，因此是稳定的。

简单的计算可以发现，奈奎斯特图与实轴的交点坐标为$- K\_1 K\_2$，因此系统稳定的条件是$-K\_1K\_2 < -1$，即$K\_1 K\_2 > 1$。

## 简化版奈奎斯特判据

奈奎斯特判据适用于所有线性系统，但是我们必须为选择的围道的每一部分计算其变换。
在之前的例子中，我们注意到，这些围道被变换后有许多相似的地方；
除此之外，我们并没有完全使用线性系统的一些条件，比如线性系统的因果性（即分子次数小于等于分母次数）等。
在这里，我们提出一个简化的奈奎斯特判据判据。

设闭环系统的开环传递函数是稳定的（即所有极点的虚部小于零），若其闭环传递函数的奈奎斯特图既不通过也不环绕临界点。
{: .proposition}

这个命题是显然的，如果一个系统的开环传递函数是稳定的，那么在奈奎斯特判据中的等式一侧就永远是零，从而另一侧也必须永远为零。

我们寻求更进一步地简化这个判据。
我们取$p = j \omega$，注意到系统的传递函数为：
$$
H_{BO}(j \omega) = \dfrac{b_0 + b_1 j\omega + \cdots + b_m (j\omega)^m}{a_0 + a_1 j\omega + \cdots + a_n (j\omega)^n}
$$
如果系统是因果系统，那么显然有$m \le n$，通常来说，这个小于关系是严格的。

现在，我们让$\omega$趋于无穷，观察其极限，正如要画出奈奎斯特判据一样。
不难注意到当$\omega \to 0$时，传递函数为一个实数$K > 0$，因此在奈奎斯特图上位于实轴正半轴上；
相对地，当$\omega \to \infty$时，其值为$\frac{b_m (j \omega)^m}{a_n (j \omega)^n} \to 0$，因此系统的奈奎斯特图从实轴上的一点出发，随$\omega$升高回到原点。
最后我们关注其图像从哪里回到原点，这就要求我们关注趋于无穷处的辐角：$\varphi(H(j\omega)) \to (n-m)\left( -\frac{\pi}{2} \right)$。
因此系统的辐角取决于分子和分母的系数之差。

接下来取$p = r\_e e^{j \theta}$，由于分子的次数小于分母的，当$r\_e \to \infty$时，系统的输出为零，因此位于原点。
这些取值和我们之前研究的完全一致。

现在我们来观察临界点是否被包围。
当$n-m = 1+4k \text{或} 2+4k$时，奈奎斯特图总是从$y$轴或$x$轴的负半轴回到原点。
此时，奈奎斯特图一定不可能包围临界点。

相对地，当$n-m = 3+4k$时，奈奎斯特图从$y$轴正半轴回到原点，此时奈奎斯特图可能包围临界点。
为了防止图像包围临界点，我们有两个要求：
1. 奈奎斯特图与负半轴的交点在$-1$右侧，即：
   $$
   \text{设} \varphi_{BO}(\omega_\pi) = - \pi, \text{则} G_{dB-BO}(\omega_\pi) < 0
   $$
   若存在多个$\omega$满足辐角为$- \pi$，则取*最大*的一个。
2. $x = -1$处的奈奎斯特图，若存在，则一定从临界点**下方**通过，即：
   $$
   \text{设} G_{dB-BO}(\omega_{CO}) = 0, \text{则} \varphi_{BO}(\omega_{CO}) > -\pi
   $$
   若存在多个$\omega$满足增益为零，则取*最大*的一个。

因此我们总结出奈奎斯特判据的最简化版本：

对开环传递函数稳定的闭环系统，其稳定，若：
$$
\begin{aligned}
    \text{若存在} \varphi_{BO} (\omega_\pi) = - \pi, &\text{那么} G_{dB-BO}(\omega_\pi) < 0 \\
    \text{若存在} G_{dB-BO}(\omega_{CO}) = 0, &\text{那么} \varphi_{BO}(\omega_{CO}) > - \pi
\end{aligned}
$$
{: .theorem}

这几个点都可以非常容易的在波德图或尼柯尔斯图中找出，因此可以利用这几个图判定系统的稳定性。

## 稳定裕度

前面介绍的闭环系统稳定性判定方法对判定抽象的、代数化的系统是非常有效的。
然而，对于实际的系统，由于建模的误差、可能的时变参数（我们假设系统是时不变的）和非线性成分，严格地使用这些方法判定系统是否稳定是不现实的。
因此，我们使用稳定性裕度的方法，进一步地判定系统具有稳定性的“余地”。

### 裕度的定义

我们定义：

**幅值裕度**（或称增益裕度）表示输入的角频率使*开环传递函数*输出相角为$-\pi$时，*开环传递函数*的增益的相反数，即：
$$
MG = -G_{dB-BO}(\omega_\pi), \text{where} \; \varphi_{BO}(\omega_\pi) = -\pi
$$
**相角裕度**表示输入的角频率使*开环传递函数*输出增益为$0$时，*开环传递函数*辐角加$\pi$，即：
$$
M\varphi = \pi + \varphi_{BO}(\omega_{C0}), \text{where} \; G_{dB-BO}(\omega_{C0}) = 0
$$
{: .definition}

不难发现，根据简化的奈奎斯特判据，如果开环传递函数稳定，那么系统的幅值裕度大于零且相角裕度大于零时，闭环系统才稳定。

对于大部分力学系统，其线性时不变模型的开环传递函数的幅值与相角裕度满足$MG \approx 10 - 12 \text{dB}$且$M\varphi \ge 45^\circ$时，实际系统才稳定。

知道幅值裕度与相角裕度的定义之后，它们都可以从波德图等图像上非常容易地看出。

### 二阶系统的相角裕度

假设一个系统的传递函数为：
$$
H(p) = \frac{1}{1 + \frac{2\xi}{\omega_0}p + \frac{p^2}{\omega_0^2}}
$$
试求其相角裕度。

首先必须注意到，我们本章中所有的稳定性判据都是针对*开环传递函数*而非整个系统的传递函数的。
为此，我们必须首先求出系统的开环传递函数。
有：
$$
H(p) = \frac{H_{BO}(p)}{1 + H_{BO}(p)}
\iff
H_{BO}(p) = \frac{H(p)}{1 - H(p)}
$$
从而：
$$
H_{BO}(p) = \frac{\frac{1}{1 + \frac{2\xi}{\omega_0}p + \frac{p^2}{\omega_0^2}}}{1 + \frac{1}{1 + \frac{2\xi}{\omega_0}p + \frac{p^2}{\omega_0^2}}}
= \frac{\omega_0^2}{p(p + 2\xi \omega_0)}
$$
这是一个比较标准的二阶系统。
其模长和辐角为：
$$
\left\{
    \begin{aligned}
        |H_{BO}(j\omega)| &= \frac{\omega_0^2}{\omega \sqrt{\omega^2 + 4 \xi^2 \omega_0^2}} \\
        \varphi_{BO}(\omega) &= - \frac{\pi}{2} - \arctan \frac{\omega}{2 \xi \omega_0}
    \end{aligned}
\right.
$$

下面我们令模长等于1，即增益等于0，求出幅值裕度：
$$
\begin{aligned}
    |H_{BO}(j\omega_{CO})| = 1 &\iff \frac{\omega_0^2}{\omega \sqrt{\omega_{CO}^2 + 4 \xi^2 \omega_0^2}} = 1 \\
    &\iff \omega_{CO}^4 + 4 \xi^2 \omega_0^2 \omega_{CO}^2 - \omega_0^4 = 0
\end{aligned}
$$
我们令$\Omega_{CO} = \omega_{CO}^2 > 0$，以简化计算。
那么利用二次函数的求根公式，可得：
$$
\Omega_{CO} = \frac{-4\xi^2\omega_0^2 \pm 2 \omega_0^2 \sqrt{4 \xi^2 + 1}}{2}
$$
考虑到这个值大于零，从而
$$
\Omega_{CO} = \omega_0^2 ( \sqrt{4 \xi^4 + 1} - 2 \xi^2)
$$
因此有：
$$
\omega_{CO} = \omega_0 \sqrt{\sqrt{4\xi^4+1} - 2\xi^2}
$$

最后代入定义求其相角裕度：
$$
\begin{aligned}
    M\varphi &= \pi + \varphi_{BO}(\omega_{CO}) \\
    &= \pi - \frac{\pi}{2} - \arctan \frac{\omega_{CO}}{2\xi\omega_0} \\
    &= \arctan \frac{2\xi\omega_0}{\omega_{CO}} \\
    &= \arctan \frac{2\xi}{\sqrt{\sqrt{4\xi^2 + 1} - 2\xi^2}} \\
    &= \arctan \frac{2}{\sqrt{\sqrt{4 + \frac{1}{\xi^4}} - 2}}
\end{aligned}
$$
这个函数具有非常好的线性近似，实际上，当$\xi < 0.7$时，我们可以认为：
$$
M\varphi = 100 \xi
$$

因此，一个二阶系统的稳定性和其阻尼密切相关。
下一章我们就会研究阻尼相关的问题。
