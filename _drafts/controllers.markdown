---
title: "控制器设计"
cateogries: "控制理论"
---

本章中我们将研究一些常见的控制器，最后以PID控制器作为控制理论的结尾。

## 控制器简述

对于一个系统，我们知道，其性能指标按照瞬态与稳态可分为阻尼与响应速度和稳定性与准确性（强健性）两组。
响应速度与准确性密切相关，阻尼和稳定性密切相关；
相应的，提高响应速度往往意味着降低阻尼和稳定性，而提高阻尼往往意味着降低速度与准确性。
系统的这些特点使得我们难以让一个系统同时让四种性能非常优秀。

为此，我们希望在控制系统中加入一个额外的环节，以此改善系统的性能。
这个环节就是控制器。

### 控制器的分类

常见的控制器可分为串联、并联和前馈三种。

串联控制器常出现在闭环系统计算误差之后，控制环节之前。
这种控制器是最常见的控制器，也是我们主要研究的控制器。

并联控制器也常出现在闭环系统中，但是其位于反馈环上，通过调节反馈的量来进行控制。

前馈控制器则通过将输入量“提前”传递给控制环节来起作用。
常见的前馈控制分为扰动补偿和误差补偿两种。

![](/assets/system/compensation-corrector.svg){: .align-center}

上图展示了常见的扰动补偿的控制器的一个例子。
设输入为$\phi(p)$计算其输出，可得：
$$\begin{aligned}
    \epsilon(p) &= P(p) + H_2(p) [H_1(p) \phi(p) - C_p(p) P(p)] \\
    &= H_1(p) H_2(p) \phi(p) + [1 - H_2(p) C_p(p)] P(p)
\end{aligned}$$
若调整前馈控制器的传递函数，使得
$$1 - H_2(p) C_p(p) = 0 \iff C_p(p) = \frac{1}{H_2(p)}$$
那么输出就可以不受扰动的影响。
可惜的是，由于$H\_2(p)$是一个因果系统，这意味着其分子多项式的阶数小于等于分母多项式的，从而取倒数后，$C\_p$很有可能不是一个因果系统，从而不存在。
实践中我们要求两者约等于即可。

![](/assets/system/compensation-correcter-2.svg){: .align-center}

上图展示了一种常见的误差补偿控制器。
设输入为$X\_c(p)$，计算器输出，计算其误差，可得：
$$
\begin{aligned}
    &\epsilon(p) = X_c(p) - H_3(p) H_2(p) [H_1(p) \epsilon(p) + C(p) X_c(p)]
    \iff & [1 + H_1(p) H_2(p) H_3(p)] \epsilon(p) = [1 - H_2(p) H_3(p) C(p)] X_c(p)
\end{aligned}
$$
同理，若能满足
$$C(p) = \frac{1}{H_2(p) H_3(p)}$$
则能使得系统的误差与输入量无关。
然而由于因果系统的限制，我们也往往只能选择约等于的情况。

## 常见串联控制器

首先，对于常见的控制系统，添加一个串联控制器意味着在其开环传递函数上乘一个额外的传递函数。
我们主要关心开环传递函数，因为正如我们在前面几章中介绍的，闭环系统的性能可以从开环传递函数中简单地推出，而不用直接研究闭环传递函数。
我们设该控制器的传递函数为$C(p)$，则其频域响应为$C(j\omega)$。
那么，新的开环传函的增益和辐角可以写为：
$$
\left\{
    \begin{aligned}
        G_{BO^\prime}(\omega) = 20 \lg |C(j\omega)| + 20 \lg |G_{BO} (\omega)| \\
        \varphi_{BO^\prime}(\omega) = \arg C(j\omega) + \varphi_{BO} (\omega)
    \end{aligned}
\right.
$$

我们可以使用这个方式对添加控制器后的系统进行分析。

### 比例控制器

比例控制器是最常见最简单的控制器之一，其传递函数如下：
$$C(p) = K, \; K \in \mathbb R_+$$

代入上式，不难发现其增益在$K>1$时增加，反之下降，而辐角不变。
从而，在波德图上，其增益部分随$K$值垂直平移，而辐角不变。

若$K>1$，从波德图上不难发现其裕度下降而带宽上升，从而稳定性下降而响应速度上升。
在尼柯尔斯图上观察，不难发现其曲线靠近临界点，从而阻尼下降。
注意到系统的稳态误差总是与整个系统的增益系数$K$反比，因此$K$上升会导致稳态误差下降，从而准确度上升。

若$K < 1$，那么结论都会反转。

上面做出的结论和章首的总结相符。

### 微分控制器

最简单的微分控制器的传递函数如下：
$$C(p) = Cp, \; C \in \mathbb R_+$$
然而，这个传递函数的分子次数大于分母次数，因此不是因果系统，所以不可能存在。
为此，我们需要进行改进。

#### 滤波微分控制器

实际中使用的微分控制器具有以下传递函数：
$$C(p) = \frac{Cp}{1 + \varepsilon p}$$
其中$\varepsilon$是一个远小于系统的特征时间的常量，从而$p$较小时其行为类似于一个微分器。

这个控制器是可以实现的，然而却存在一个巨大的问题。
不难发现这个控制器的截止频率为$\frac{1}{\varepsilon} \ge 1$。
输入频率远小于截止频率时，增益趋于负无穷；而输入频率非常高时，增益趋于常数。
这个控制器的行为和一个高通滤波器一致，因此得名。

然而，在控制器引入高通滤波并非非常实用，因为传感器的噪声往往是高频的，从而这个控制器会放大噪声，导致不良的后果。
因此，微分控制器往往不会单独使用。

#### 比例微分控制器

比例微分控制器将一个微分控制器与一个比例控制器相加，在时域上可表示为：
$$u(t) = A \epsilon(t) + B \dot \epsilon(t)$$
其中$\epsilon$表示误差，通常为控制器的输入。
那么，在频域上，其传递函数可写为：
$$C(p) = A + B \frac{p}{1 + \varepsilon p} \approx \frac{1}{1+\varepsilon p}(A + Bp) = \frac{A}{1+\varepsilon p}(1 + \frac{B}{A} p)$$
注意到$\varepsilon$是一个非常小的数，因此可以进行这种近似。

在这个控制器中，我们依然使用滤波微分控制器作为微分控制器的近似。

计算其增益和辐角，可得：
$$
\begin{aligned}
    G_{dB-C} (\omega) &= 20 \lg A + 10 \lg (1 + \frac{B^2 \omega^2}{A^2}) - 10 \lg (1 + \varepsilon^2 \omega^2) \\
    \varphi_C (\omega) &= \arctan \frac{B\omega}{A} - \arctan \varepsilon \omega
\end{aligned}
$$

这个控制器具有两个截止频率：$\omega\_{c1} = \frac{A}{B}$和$\omega\_{c2} = \frac{1}{\varepsilon}$。
考虑到$\varepsilon$非常小，这意味着$\omega\_{c1} < \omega\_{c2}$。

系统的波德图具有三条渐进线：
- $\omega < \omega\_{c1}$时，增益为常数$20 \lg A$，相角为零；
- $\omega\_{c1} < \omega < \omega\_{c2}$时，增益为一条斜率为正二十的直线，相角为$\frac{\pi}{2}$；
- $\omega\_{c2} < \omega$时，增益为常数$20 \lg \frac{B}{\varepsilon}$，相角为零。

这个控制器略好于直接的微分控制器，其不会完全抑制低频分量，但是仍会放大高频分量，导致噪音被放大。
因此，常见的控制器中一般不使用微分环节。
常见的PID控制器中通常只有20%含有微分环节。

### 相位超前控制器
