---
title: "几个常见的数学模型"
---

## 房室模型

房室模型通过将研究的整体分为各个部分，然后在研究各个部分之间的转移来达成求解模型的目的。
通常，房室之间的转移可由一组微分方程描述。

### 药代动力学模型

药代动力学主要研究药物的释放、吸收、分布、代谢和排泄问题，后两个阶段也可统称排除。

药代动力学模型中最常用的为二室模型，这种模型中只存在两个房室：中心室和周边室。
中心室表示血液富集的区域，如血管、心、肺等器官；
周边室表示血液较少的区域，如肌肉等。

对这个模型，通常有以下假设：
1. 两个房室的容积，即血液的体积，保持不变；
2. 药物从一个房室转移到其他阶段的速率正比于药物在该室内的浓度；
3. 只有中心室与体外有药物交换，药物通过释放进入中心室，然后从中心室排除，其他浓度变化忽略不计。

从而，中心室有三个参数$c\_1(t), x\_1(t), V\_1$，周边室也有三个参数$c\_2(t), x\_2(t), V\_2$，分别表示药物浓度、药量和容积。
此外，还有一个函数$f(t)$表示给药速率，常数$k\_{ij}$表示阶段之间的转移常数。
我们可以列出以下方程：
$$
\begin{cases}
    \dot x_1 (t) &= -k_{12}x_1(t) - k_{13} x_1(t) + k_{21} x_2(t) + f_0(t) \\
    \dot x_2 (t) &= k_{12} x_1(t) - k_{21} x_2(t)
\end{cases}
$$
除此之外，还有：
$$x_1(t) = c_1(t) V_1, \; x_2(t) = c_2(t) V_2$$
代入原方程，可得：
$$
\begin{cases}
\dot c_1(t) &= - (k_{12} + k_{13}) c_1(t) + \frac{V_2}{V_1} k_{21} c_2(t) + \frac{f_0(t)}{V_1} \\
\dot c_2(t) &= \frac{V_1}{V_2} k_{12} c_1(t) - k_{21} c_2(t)
\end{cases}
$$

这是简单的非齐次一阶线性方程组，容易求解。

值得注意的是，给药速率$f\_0(t)$对这组微分方程的解有非常大的影响，这意味着欲研究不同的给药方式，就需要给出合适的给药速率函数。

### 传染病模型

我们使用一系列微分方程模型来对传染病的传播进行建模，其中最简单而常用的两种模型为SIS模型和SIR模型。
这些模型都可以看作房室模型。

#### SI模型

我们首先研究最简单的模型——SI模型，作为剩下两种的铺垫。

SI模型把人口分为两个部分：易感染者（Susceptibles）和已感染者（Infectives）。

该模型中，我们假设总人数$N$不变，而两者的*比例*分别为$s(t)$和$i(t)$。
除此之外，我们还假设每一个病人每天能与$\lambda$接触并导致他们患病，这一比例称为*日接触率*。

那么该模型可由以下这组方程表示：
$$
\left\{
    \begin{aligned}
    \frac{\mathrm d i}{\mathrm d t} &= \lambda i(t) s(t) \\
    i(t) + s(t) &= 1 \\
    i(0) &= i_0
    \end{aligned}
\right.
$$
使用第二个等式代换第一个等式中的$s(t)$，即可得：
$$\frac{\mathrm di}{\mathrm d t} = \lambda i(t) (1-i(t))$$
具有这种方程的模型称为逻辑斯蒂模型，是我们下一部分研究的重点。

这个方程具有解析解，其解如下：
$$i(t) = \frac{1}{1 + \left(\frac{1}{i_0}-1\right)e^{-\lambda t}}$$

不难注意到$i(\infty) = 1$，这意味着所有人最终都会被感染。
考虑到这个系统中不存在治愈这种可能，这个结果是符合直观的。

#### SIS模型

SIS模型在SI模型基础之上建立了从已感染者回到易感染者的通路，这可以用来对感染并治愈后对疾病的免疫力没有显著提高的疾病进行建模。

SIS模型在前一个模型的基础之上，假设病人每天被治愈的比例为$\mu$，其方程可写为：
$$
\left\{
    \begin{aligned}
    \frac{\mathrm d i}{\mathrm d t} &= \lambda i (1-i) - \mu i = - \lambda i [i - (1 - \frac{1}{\sigma})] \\
    i(0)&= i_0
    \end{aligned}
\right.
$$
其中$\sigma = \frac{\lambda}{\mu}$，表示一个感染期内每个病人的有效接触人数，称为*接触数*。

这个方程的解析解求解比较困难，但定性的分析不难给出：
$$i(\infty) = \begin{cases} 1 - \frac{1}{\sigma} &, \sigma > 1 \\ 0 &, \sigma \le 1  \end{cases}$$
这意味着该疾病能否得到控制与其接触数密切相关。

#### SIR模型

SIR模型在SI模型的基础上新增了移出者（Removed），用来表示被移出感染系统的人数。
这一移出可以是被治愈并获得免疫者，也可能是病死者。

我们维持此前的定义不变，只是将治愈率$\mu$重命名为移出率，其方程可写为：
$$
\left\{
    \begin{aligned}
    \frac{\mathrm d i}{\mathrm d t} &= \lambda s i - \mu i \\
    \frac{\mathrm d s}{\mathrm d t} &= -\lambda s i \\
    i(0) &= i_0 \\
    s(0) &= s_0
    \end{aligned}
\right.
$$

我们可以使用这个方程来画出其相轨线：
$$\frac{\mathrm d i}{\mathrm d s} = \frac{1}{\sigma s} - 1$$

这个模型不具有解析解，但是平衡点和相轨线分析表明，其趋势与$s_0 \cdot \sigma$密切相关。
若$s\_0 \cdot \sigma \ge 1$，那么$i(t)$先上升再下降至零；
若$s\_0 \cdot \sigma < 1$，那么$i(t)$单调下降至零，这意味者传染病不会蔓延。

因此，$s\_0 \sigma$，即初始易感比率与接触数之积，是预测传染病传播的一项重要数据，称为*基本再生数*。
常见传染性疾病的基本再生数在一至十之间。
据估计，2019-nCoV的基本再生数约在2.3-5之间。

这项数据为预防传染病蔓延提供了一些方法：
1. 降低$s\_0$。
注意到易感比例、感染比例和移出比例之和为一，而初始时刻感染比例通常非常小，可视为零，那么通过接种疫苗等方式增加移出比例可降低$s\_0$。
2. 降低$\sigma$。
这可通过降低$\lambda$或提高$\mu$来实现。

## 逻辑斯蒂模型

逻辑斯蒂模型是一大类解具有逻辑斯蒂函数的形式的模型的总成。
逻辑斯蒂函数，是一种S型函数，可用来表示一个增长既收到其自己的促进，又收到自己的抑制的物理量随时间的变化，如生物种群等。

逻辑斯蒂模型的微分方程通常具有以下形式：
$$\frac{\mathrm d x}{\mathrm d t} = r x (1 - \frac{x}{x_m})$$
其通解为：
$$x(t) = \frac{x_m}{1 + (\frac{x_m}{x_0} - 1) e^{-rt}}$$

### Leslie模型

逻辑斯蒂模型可较好地描述种群的增长，但是却无法给出更多人口性别或年龄分层的数据。
为了更好地确定人口的年龄分组，我们使用Leslie模型。
这个模型是一个差分模型，并非逻辑斯蒂模型。

假设我们将种群分为$n$个年龄层，其中年龄最小的人数为$x\_1$。
Leslie模型使用几个差分方程来估计种群数量：
$$x_1(k+1) = \sum_{i=1}^n b_i x_i(k), \; x_{i+1}(k+1) = s_i x_i(k)$$
第一个方程表示各个年龄分组产下的新个体，全部进入年龄最小的年龄组内，$b\_i$称为*出生率*。
第二个方程表示年龄分组的成长，$s\_i$称为*存活率*。

若我们把种群数写成向量的形式：
$$x(k) = \begin{bmatrix} x_1(k) & \cdots & x_n(k) \end{bmatrix}^\top$$
那么这个差分方程可由一个矩阵与其相乘表示：
$$L = \begin{bmatrix}
b_1 & b_2 & \cdots & b_{n-1} & b_n \\
s_1 & 0 & \cdots & 0 & 0 \\
0 & s_2 & \cdots & 0 & 0 \\
\vdots & \vdots & \ddots & \vdots & \vdots \\
0 & 0 & \cdots & s_{n-1} & 0
\end{bmatrix}, x(k+1) = L x(k)$$
矩阵$L$称为Leslie矩阵。

#### Leslie模型的稳态分析

特征值是对矩阵进行分析的有力手段，因此我们也借助它对Leslie矩阵进行分析。
设其最大单特征值为$\lambda\_1$，通过简单的计算可知其特征向量可写为：
$$x^* = \begin{bmatrix} 1, \frac{s_1}{\lambda_1}, \frac{s_1 s_2}{\lambda_1^2}, \cdots, \frac{s_1 s_2 \cdots s_{n-1}}{\lambda_1^{n-1}} \end{bmatrix}^\top$$

不妨设该矩阵可对角化：
$$L = P\times \mathrm{diag}(\lambda_1, \cdots, \lambda_n) \times P^{-1}$$
注意到所有其他特征值均小于$\lambda\_1$，我们有：
$$\lim_{k \to \infty} \frac{x(k)}{\lambda_1^k} = P \times \mathrm{diag}(1, 0, \cdots, 0) \times P^{-1} \times x(0)$$
又因为$P$的第一列正是第一个特征向量$x^*$，我们可以认为：
$$x(\infty) = c x^*$$
其中$c$是一个由Leslie矩阵和$x(0)$决定的常量。

注意到特征向量$x^*$与初态无关，这个分布向量称为*稳定分布*。

### 种群模型

## 优化模型

### 单变量优化模型：仓储问题

## 线性规划模型

### 单纯形法
